{
  "version": 3,
  "sources": ["../index.ts"],
  "sourcesContent": ["import { createServer } from \"node:http2\";\n\nimport { serve } from \"@hono/node-server\";\nimport { serveStatic } from \"@hono/node-server/serve-static\";\nimport { type AppLoadContext } from \"@remix-run/node\";\nimport { Hono } from \"hono\";\n// import { serveStatic } from \"hono/bun\";\nimport { logger } from \"hono/logger\";\nimport { remix } from \"remix-hono/handler\";\n\nimport { httpsOnly } from \"./server/middlewares/https-only\";\nimport { setNonce } from \"./server/middlewares/nonce\";\nimport { removeTrailingSlash } from \"./server/middlewares/remove-trailing-slash\";\nimport { secureHeaders } from \"./server/middlewares/secure-headers\";\n\nconst MODE = process.env.NODE_ENV === \"production\" ? \"production\" : \"development\";\n\nconst BUILD_PATH = \"../build/index.js\";\nconst build = await import(BUILD_PATH);\n\ntype Env = {\n\tVariables: { nonce: string };\n};\n\nconst server = new Hono<Env>().use(\n\t\"*\",\n\thttpsOnly,\n\tremoveTrailingSlash,\n\tsetNonce,\n\tsecureHeaders,\n);\n\nserver.get(\"/ping\", (c) => c.json({ pong: \"pong\" }, 200));\n\nserver.get(\"/assets/*\", (c, next) => {\n\tc.res.headers.set(\"Cache-Control\", \"max-age=31556952\");\n\treturn serveStatic({ root: \".\" })(c, next);\n});\n\nserver.get(\"/public/*\", (c, next) => {\n\tc.res.headers.set(\"Cache-Control\", \"max-age=3600\");\n\treturn serveStatic({ root: \".\" })(c, next);\n});\n\n// TODO rate-limiting?\n\n// @ts-expect-error idk\nserver.use(\n\t\"*\",\n\tlogger(),\n\tremix({\n\t\tmode: MODE,\n\t\tbuild,\n\t\tgetLoadContext: (env) => env as any as AppLoadContext,\n\t}),\n);\n\nconsole.info(\"Server started\");\nserve({ fetch: server.fetch, createServer });\n// export default server;\n"],
  "mappings": "AAAA,SAAS,oBAAoB;AAE7B,SAAS,aAAa;AACtB,SAAS,mBAAmB;AAE5B,SAAS,YAAY;AAErB,SAAS,cAAc;AACvB,SAAS,aAAa;AAEtB,SAAS,iBAAiB;AAC1B,SAAS,gBAAgB;AACzB,SAAS,2BAA2B;AACpC,SAAS,qBAAqB;AAE9B,MAAM,OAAO,QAAQ,IAAI,aAAa,eAAe,eAAe;AAEpE,MAAM,aAAa;AACnB,MAAM,QAAQ,MAAM,OAAO;AAM3B,MAAM,SAAS,IAAI,KAAU,EAAE;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD;AAEA,OAAO,IAAI,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,OAAO,GAAG,GAAG,CAAC;AAExD,OAAO,IAAI,aAAa,CAAC,GAAG,SAAS;AACpC,IAAE,IAAI,QAAQ,IAAI,iBAAiB,kBAAkB;AACrD,SAAO,YAAY,EAAE,MAAM,IAAI,CAAC,EAAE,GAAG,IAAI;AAC1C,CAAC;AAED,OAAO,IAAI,aAAa,CAAC,GAAG,SAAS;AACpC,IAAE,IAAI,QAAQ,IAAI,iBAAiB,cAAc;AACjD,SAAO,YAAY,EAAE,MAAM,IAAI,CAAC,EAAE,GAAG,IAAI;AAC1C,CAAC;AAKD,OAAO;AAAA,EACN;AAAA,EACA,OAAO;AAAA,EACP,MAAM;AAAA,IACL,MAAM;AAAA,IACN;AAAA,IACA,gBAAgB,CAAC,QAAQ;AAAA,EAC1B,CAAC;AACF;AAEA,QAAQ,KAAK,gBAAgB;AAC7B,MAAM,EAAE,OAAO,OAAO,OAAO,aAAa,CAAC;",
  "names": []
}
